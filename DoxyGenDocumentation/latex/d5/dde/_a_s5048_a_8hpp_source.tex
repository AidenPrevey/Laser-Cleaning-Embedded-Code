\doxysection{AS5048\+A.\+hpp}
\hypertarget{_a_s5048_a_8hpp_source}{}\label{_a_s5048_a_8hpp_source}\index{include/AS5048A.hpp@{include/AS5048A.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ as5048\_h}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ as5048\_h}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <Arduino.h>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <SPI.h>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}butterworth.hpp"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_a_s5048_a}{AS5048A}}}
\DoxyCodeLine{00010\ \{}
\DoxyCodeLine{00011\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ uint16\_t\ FULL\_SCALE\ =\ 16384;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 16\ 384\ counts\ (2\string^14)}}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ uint16\_t\ HALF\_SCALE\ =\ FULL\_SCALE\ /\ 2;\ \ \textcolor{comment}{//\ 8\ 192\ counts\ (half\ turn)}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \ \ \ \ uint8\_t\ \_cs;}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keywordtype}{bool}\ errorFlag;}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keywordtype}{bool}\ ocfFlag;\ \ \textcolor{comment}{//\ Avoid\ printing\ OCF\ flag\ everytime}}
\DoxyCodeLine{00018\ \ \ \ \ uint16\_t\ position\ =\ 0;}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordtype}{bool}\ debug;}
\DoxyCodeLine{00020\ \ \ \ \ uint8\_t\ esp32\_delay;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ int32\_t\ revCount\ =\ 0;\ \ \ \ \ \textcolor{comment}{//\ signed\ \#\ of\ full\ 360Â°\ turns\ since\ start-\/up}}
\DoxyCodeLine{00023\ \ \ \ \ uint16\_t\ prevRaw\ =\ 0;\ \ \textcolor{comment}{//\ previous\ raw\ sample\ (initialised\ on\ first\ call)}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordtype}{bool}\ prevRawinitialized\ =\ \textcolor{keyword}{false};\ \ \textcolor{comment}{//\ flag\ to\ check\ if\ prevRaw\ has\ been\ initialized}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ SPISettings\ settings;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ uint8\_t\ spiCalcEvenParity(uint16\_t);}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{static}\ uint8\_t\ spiCheckParity(uint16\_t\ value);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{class_discrete_filter}{DiscreteFilter<4>}}\ \mbox{\hyperlink{namespacefilter}{filter}};\ \ \textcolor{comment}{//\ Butterworth\ filter\ for\ smoothing\ the\ angle\ readings}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{void}\ setDelay();}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{void}\ close();}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00046\ \textcolor{comment}{\ \ \ \ \ *\ Read\ a\ register\ from\ the\ sensor}}
\DoxyCodeLine{00047\ \textcolor{comment}{\ \ \ \ \ *\ Takes\ the\ address\ of\ the\ register\ as\ a\ 16\ bit\ uint16\_t}}
\DoxyCodeLine{00048\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ the\ value\ of\ the\ register}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00050\ \ \ \ \ uint16\_t\ read(uint16\_t\ registerAddress);}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00053\ \textcolor{comment}{\ \ \ \ \ *\ Write\ to\ a\ register}}
\DoxyCodeLine{00054\ \textcolor{comment}{\ \ \ \ \ *\ Takes\ the\ 16-\/bit\ \ address\ of\ the\ target\ register\ and\ the\ 16\ bit\ uint16\_t\ of\ data}}
\DoxyCodeLine{00055\ \textcolor{comment}{\ \ \ \ \ *\ to\ be\ written\ to\ that\ register}}
\DoxyCodeLine{00056\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ the\ value\ of\ the\ register\ after\ the\ write\ has\ been\ performed.\ This}}
\DoxyCodeLine{00057\ \textcolor{comment}{\ \ \ \ \ *\ is\ read\ back\ from\ the\ sensor\ to\ ensure\ a\ sucessful\ write.}}
\DoxyCodeLine{00058\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00059\ \ \ \ \ uint16\_t\ write(uint16\_t\ registerAddress,\ uint16\_t\ data);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00066\ \ \ \ \ int16\_t\ getRotation();}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ \ \ *\ Check\ if\ an\ error\ has\ been\ encountered.}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordtype}{bool}\ error();}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{class_a_s5048_a_a48bee9a7b8eeb1a8b8ab7053bff11864}{AS5048A}}(uint8\_t\ arg\_cs,\ \textcolor{keywordtype}{bool}\ debug\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_a_s5048_a_a9393f5f154cf5ea08eb01244a06fa6bb}{begin}}();}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ int32\_t\ getRevolutions()\ \{\ \textcolor{keywordflow}{return}\ revCount;\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00090\ \ \ \ \ int16\_t\ \mbox{\hyperlink{class_a_s5048_a_afe90817275f5893416d54962534347b2}{getRawRotation}}();}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00095\ \ \ \ \ int32\_t\ \mbox{\hyperlink{class_a_s5048_a_a960a8658590f61673328d1c1cdacd016}{getRotationUnwrapped}}();}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_a_s5048_a_a0ba1e7e023ec7df38564a5d05e82bec9}{getRotationInDegrees}}();}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_a_s5048_a_a40ecdea569599028102a14730ec7c9d4}{getRotationInRadians}}();}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_a_s5048_a_a82e0d1122cdbfbbbd2be18df3dc723fb}{getRotationUnwrappedInRadians}}();}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00122\ \ \ \ \ uint16\_t\ \mbox{\hyperlink{class_a_s5048_a_afee7dc02f73ab15b0ced5b756ca0d6de}{getState}}();}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_a_s5048_a_ab14e60942c472eefa2092d0701a96028}{printState}}();}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00133\ \ \ \ \ uint8\_t\ \mbox{\hyperlink{class_a_s5048_a_a4734f6924cfd91f5ca5697e6e4915d92}{getGain}}();}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ \ \ \ \ *\ Get\ and\ clear\ the\ error\ register\ by\ reading\ it}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00138\ \ \ \ \ String\ getErrors();}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00143\ \ \ \ \ String\ \mbox{\hyperlink{class_a_s5048_a_ad1c42ff9013cf02015b7d196f8347e10}{getDiagnostic}}();}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00146\ \textcolor{comment}{\ \ \ \ \ *\ Set\ the\ zero\ position}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{keywordtype}{void}\ setZeroPosition(uint16\_t\ arg\_position);}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00151\ \textcolor{comment}{\ \ \ \ \ *\ Returns\ the\ current\ zero\ position}}
\DoxyCodeLine{00152\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00153\ \ \ \ \ uint16\_t\ getZeroPosition();}
\DoxyCodeLine{00154\ \};}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
