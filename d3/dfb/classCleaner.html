<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Laser Cleaning Robot: Cleaner Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Laser Cleaning Robot
   </div>
   <div id="projectbrief">:)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../dd/df1/classCleaner-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Cleaner Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">State</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ad3f2796d3726efad26b5f2803615d5d3" id="r_ad3f2796d3726efad26b5f2803615d5d3"><td class="memItemLeft" align="right" valign="top"><a id="ad3f2796d3726efad26b5f2803615d5d3" name="ad3f2796d3726efad26b5f2803615d5d3"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>CleanerOperatorMode</b> { <b>MANUAL</b> = 0
, <b>AUTO</b> = 1
, <b>DEBUG</b>
 }</td></tr>
<tr class="separator:ad3f2796d3726efad26b5f2803615d5d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa3b1cecadf34f714855909bd05123138" id="r_aa3b1cecadf34f714855909bd05123138"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3b1cecadf34f714855909bd05123138">Cleaner</a> ()</td></tr>
<tr class="memdesc:aa3b1cecadf34f714855909bd05123138"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> object and initializes all member components.  <br /></td></tr>
<tr class="separator:aa3b1cecadf34f714855909bd05123138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac051a223500b358993b956c6aa859c06" id="r_ac051a223500b358993b956c6aa859c06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac051a223500b358993b956c6aa859c06">begin</a> ()</td></tr>
<tr class="memdesc:ac051a223500b358993b956c6aa859c06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system and its components. Designed to be ran once at start.  <br /></td></tr>
<tr class="separator:ac051a223500b358993b956c6aa859c06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae155057833b9ca4a728d72b4788458cd" id="r_ae155057833b9ca4a728d72b4788458cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae155057833b9ca4a728d72b4788458cd">reset</a> ()</td></tr>
<tr class="memdesc:ae155057833b9ca4a728d72b4788458cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the cleaner system to its default state.  <br /></td></tr>
<tr class="separator:ae155057833b9ca4a728d72b4788458cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fed5f818bc46e22a3af4150ca9ed761" id="r_a6fed5f818bc46e22a3af4150ca9ed761"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6fed5f818bc46e22a3af4150ca9ed761">shutdown</a> ()</td></tr>
<tr class="memdesc:a6fed5f818bc46e22a3af4150ca9ed761"><td class="mdescLeft">&#160;</td><td class="mdescRight">Safely shuts down the cleaner system by stopping all motors and setting the emergency stop flag.  <br /></td></tr>
<tr class="separator:a6fed5f818bc46e22a3af4150ca9ed761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d5deed349838f9219c686ac8414412e" id="r_a4d5deed349838f9219c686ac8414412e"><td class="memItemLeft" align="right" valign="top"><a id="a4d5deed349838f9219c686ac8414412e" name="a4d5deed349838f9219c686ac8414412e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>home</b> (<a class="el" href="../../d0/db4/classSerialReceiverTransmitter_1_1CommandMessage.html">SerialReceiverTransmitter::CommandMessage</a> command)</td></tr>
<tr class="separator:a4d5deed349838f9219c686ac8414412e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6fa0c442fe78946f1b8647cfa2a1695" id="r_aa6fa0c442fe78946f1b8647cfa2a1695"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa6fa0c442fe78946f1b8647cfa2a1695">processCommand</a> (<a class="el" href="../../d0/db4/classSerialReceiverTransmitter_1_1CommandMessage.html">SerialReceiverTransmitter::CommandMessage</a> command)</td></tr>
<tr class="memdesc:aa6fa0c442fe78946f1b8647cfa2a1695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes a received command and updates the system state accordingly.  <br /></td></tr>
<tr class="separator:aa6fa0c442fe78946f1b8647cfa2a1695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71dc3ef17b35f15b0eab11a773503dd" id="r_ae71dc3ef17b35f15b0eab11a773503dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae71dc3ef17b35f15b0eab11a773503dd">run</a> ()</td></tr>
<tr class="memdesc:ae71dc3ef17b35f15b0eab11a773503dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the ~300kHz control loop for the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system.  <br /></td></tr>
<tr class="separator:ae71dc3ef17b35f15b0eab11a773503dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c70ec1e1156ac7986d260e50516d946" id="r_a8c70ec1e1156ac7986d260e50516d946"><td class="memItemLeft" align="right" valign="top"><a id="a8c70ec1e1156ac7986d260e50516d946" name="a8c70ec1e1156ac7986d260e50516d946"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>initializeManualMode</b> ()</td></tr>
<tr class="memdesc:a8c70ec1e1156ac7986d260e50516d946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the manual mode by setting des_state_ to make all the jog dials relative to the position you're in when hitting the switch. <br /></td></tr>
<tr class="separator:a8c70ec1e1156ac7986d260e50516d946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03be2db45010be9d99c80094a531852" id="r_af03be2db45010be9d99c80094a531852"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af03be2db45010be9d99c80094a531852">initializeAutoMode</a> (<a class="el" href="../../d6/d80/classSerialReceiverTransmitter.html">SerialReceiverTransmitter</a> &amp;receiver)</td></tr>
<tr class="memdesc:af03be2db45010be9d99c80094a531852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the auto mode by resetting the system state and reseting the receiver line to prevent the system from running to the last received message and wait for a new one.  <br /></td></tr>
<tr class="separator:af03be2db45010be9d99c80094a531852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968b84237dc3e9425cfea3e4c771f5cd" id="r_a968b84237dc3e9425cfea3e4c771f5cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a968b84237dc3e9425cfea3e4c771f5cd">stop</a> ()</td></tr>
<tr class="memdesc:a968b84237dc3e9425cfea3e4c771f5cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops all motors managed by the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> instance.  <br /></td></tr>
<tr class="separator:a968b84237dc3e9425cfea3e4c771f5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af33f015424fd1d4082f384577f7a8235" id="r_af33f015424fd1d4082f384577f7a8235"><td class="memItemLeft" align="right" valign="top"><a id="af33f015424fd1d4082f384577f7a8235" name="af33f015424fd1d4082f384577f7a8235"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>PCFMessageRec</b> ()</td></tr>
<tr class="memdesc:af33f015424fd1d4082f384577f7a8235"><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR for the PCF8575. <br /></td></tr>
<tr class="separator:af33f015424fd1d4082f384577f7a8235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54f9a4e625933e4f5bdc16f3b6ac0f5e" id="r_a54f9a4e625933e4f5bdc16f3b6ac0f5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54f9a4e625933e4f5bdc16f3b6ac0f5e">updatePCF8575</a> ()</td></tr>
<tr class="memdesc:a54f9a4e625933e4f5bdc16f3b6ac0f5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the state of the PCF8575 I/O expander and related system components.  <br /></td></tr>
<tr class="separator:a54f9a4e625933e4f5bdc16f3b6ac0f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1f7dd1742474f10e449fdecbe8f9e3" id="r_a4e1f7dd1742474f10e449fdecbe8f9e3"><td class="memItemLeft" align="right" valign="top"><a id="a4e1f7dd1742474f10e449fdecbe8f9e3" name="a4e1f7dd1742474f10e449fdecbe8f9e3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>updateModeAuto</b> ()</td></tr>
<tr class="memdesc:a4e1f7dd1742474f10e449fdecbe8f9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to see if we need to switch from auto mode. <br /></td></tr>
<tr class="separator:a4e1f7dd1742474f10e449fdecbe8f9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa310ec1a7161cf0a40e3ac37836c2acd" id="r_aa310ec1a7161cf0a40e3ac37836c2acd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa310ec1a7161cf0a40e3ac37836c2acd">updateDesStateManual</a> ()</td></tr>
<tr class="memdesc:aa310ec1a7161cf0a40e3ac37836c2acd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the desired state of the cleaner system in manual mode based on encoder inputs.  <br /></td></tr>
<tr class="separator:aa310ec1a7161cf0a40e3ac37836c2acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0202b0d88fc67277b9f6590164830576" id="r_a0202b0d88fc67277b9f6590164830576"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0202b0d88fc67277b9f6590164830576">updateRealState</a> ()</td></tr>
<tr class="memdesc:a0202b0d88fc67277b9f6590164830576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates and returns the real-time state of the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system.  <br /></td></tr>
<tr class="separator:a0202b0d88fc67277b9f6590164830576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42c5c123958fae9e3b55dd18a0b5b57c" id="r_a42c5c123958fae9e3b55dd18a0b5b57c"><td class="memItemLeft" align="right" valign="top"><a id="a42c5c123958fae9e3b55dd18a0b5b57c" name="a42c5c123958fae9e3b55dd18a0b5b57c"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isAutoMode</b> () const</td></tr>
<tr class="separator:a42c5c123958fae9e3b55dd18a0b5b57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd56a694ded69ec04554ac3ea1ddbaf1" id="r_afd56a694ded69ec04554ac3ea1ddbaf1"><td class="memItemLeft" align="right" valign="top"><a id="afd56a694ded69ec04554ac3ea1ddbaf1" name="afd56a694ded69ec04554ac3ea1ddbaf1"></a>
PCF8575&#160;</td><td class="memItemRight" valign="bottom"><b>getIOExpander</b> () const</td></tr>
<tr class="separator:afd56a694ded69ec04554ac3ea1ddbaf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d71e31f5a67332e5982e70b7d50f50b" id="r_a2d71e31f5a67332e5982e70b7d50f50b"><td class="memItemLeft" align="right" valign="top"><a id="a2d71e31f5a67332e5982e70b7d50f50b" name="a2d71e31f5a67332e5982e70b7d50f50b"></a>
<a class="el" href="../../d4/d7a/classStepperMotor.html">StepperMotor</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getJawRotationMotor</b> ()</td></tr>
<tr class="separator:a2d71e31f5a67332e5982e70b7d50f50b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96359358d78fcd18daea9706ec9759d5" id="r_a96359358d78fcd18daea9706ec9759d5"><td class="memItemLeft" align="right" valign="top"><a id="a96359358d78fcd18daea9706ec9759d5" name="a96359358d78fcd18daea9706ec9759d5"></a>
<a class="el" href="../../d4/d7a/classStepperMotor.html">StepperMotor</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getJawPosMotor</b> ()</td></tr>
<tr class="separator:a96359358d78fcd18daea9706ec9759d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ebd0e8eb1bc194da41abcbfbc5db64" id="r_a84ebd0e8eb1bc194da41abcbfbc5db64"><td class="memItemLeft" align="right" valign="top"><a id="a84ebd0e8eb1bc194da41abcbfbc5db64" name="a84ebd0e8eb1bc194da41abcbfbc5db64"></a>
<a class="el" href="../../d4/d7a/classStepperMotor.html">StepperMotor</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getClampMotor</b> ()</td></tr>
<tr class="separator:a84ebd0e8eb1bc194da41abcbfbc5db64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c9740adbc3dc08cc5c8c1d15e813f47" id="r_a1c9740adbc3dc08cc5c8c1d15e813f47"><td class="memItemLeft" align="right" valign="top"><a id="a1c9740adbc3dc08cc5c8c1d15e813f47" name="a1c9740adbc3dc08cc5c8c1d15e813f47"></a>
<a class="el" href="../../d2/dd0/classAS5048A.html">AS5048A</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getEncoder</b> ()</td></tr>
<tr class="separator:a1c9740adbc3dc08cc5c8c1d15e813f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:abbefbeacf707f5f7f6f4c334e69dbca8" id="r_abbefbeacf707f5f7f6f4c334e69dbca8"><td class="memItemLeft" align="right" valign="top"><a id="abbefbeacf707f5f7f6f4c334e69dbca8" name="abbefbeacf707f5f7f6f4c334e69dbca8"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>updatePCF8575_flag</b> = false</td></tr>
<tr class="separator:abbefbeacf707f5f7f6f4c334e69dbca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa3b1cecadf34f714855909bd05123138" name="aa3b1cecadf34f714855909bd05123138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b1cecadf34f714855909bd05123138">&#9670;&#160;</a></span>Cleaner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Cleaner::Cleaner </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> object and initializes all member components. </p>
<p>This constructor initializes the jaw rotation, jaw position, and clamp motors with their respective configurations. It also sets up the encoder for clamp position, lowpass filters for clamp and jaw encoder signals, and the PID controller for the clamp. The jaw rotation, jaw position, and clamp encoders are initialized with their respective pins and IO extender read callbacks. Motors are added to the internal array for management, and default motion, electrical, and physical profiles are applied to each motor. Finally, the system is reset to its initial state. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac051a223500b358993b956c6aa859c06" name="ac051a223500b358993b956c6aa859c06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac051a223500b358993b956c6aa859c06">&#9670;&#160;</a></span>begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Cleaner::begin </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system and its components. Designed to be ran once at start. </p>
<p>This function performs the following initialization steps:</p><ul>
<li>Initializes the I2C communication bus.</li>
<li>Initializes all motors in the system. If any motor fails to initialize, an error message is printed to the serial port and the function returns failure.</li>
<li>Initializes the encoder.</li>
<li>Registers an interrupt handler for the IO extender if the interrupt pin is defined.</li>
<li>Initializes the IO extender.</li>
<li>Configures the necessary GPIO pins for limit switch, emergency stop, and roll brake.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>int Returns EXIT_SUCCESS on successful initialization, or EXIT_FAILURE if any component fails to initialize. </dd></dl>

</div>
</div>
<a id="af03be2db45010be9d99c80094a531852" name="af03be2db45010be9d99c80094a531852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03be2db45010be9d99c80094a531852">&#9670;&#160;</a></span>initializeAutoMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cleaner::initializeAutoMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d80/classSerialReceiverTransmitter.html">SerialReceiverTransmitter</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>receiver</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the auto mode by resetting the system state and reseting the receiver line to prevent the system from running to the last received message and wait for a new one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">receiver</td><td>Handle to the serial receiver being used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa6fa0c442fe78946f1b8647cfa2a1695" name="aa6fa0c442fe78946f1b8647cfa2a1695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6fa0c442fe78946f1b8647cfa2a1695">&#9670;&#160;</a></span>processCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cleaner::processCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/db4/classSerialReceiverTransmitter_1_1CommandMessage.html">SerialReceiverTransmitter::CommandMessage</a></td>          <td class="paramname"><span class="paramname"><em>command</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes a received command and updates the system state accordingly. </p>
<p>This function interprets the provided command message and performs actions such as moving motors, setting speeds, accelerations, current limits, or executing homing and dwell commands. Each command type (G0, G4, G28, G90, M80, M17, M906) is handled individually, updating the desired state or hardware parameters as required.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">command</td><td>The command message received from the serial interface, containing various possible instructions for the cleaner system. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae155057833b9ca4a728d72b4788458cd" name="ae155057833b9ca4a728d72b4788458cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae155057833b9ca4a728d72b4788458cd">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Cleaner::reset </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the cleaner system to its default state. </p>
<p>This function zeroes out the internal state and desired state structures, and resets the current position of all motors to zero.</p>
<dl class="section return"><dt>Returns</dt><dd>EXIT_SUCCESS on successful reset. </dd></dl>

</div>
</div>
<a id="ae71dc3ef17b35f15b0eab11a773503dd" name="ae71dc3ef17b35f15b0eab11a773503dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71dc3ef17b35f15b0eab11a773503dd">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cleaner::run </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the ~300kHz control loop for the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system. </p>
<p>This function performs the following actions:</p><ul>
<li>Checks if the system is in an emergency stop (E-Stop) state and exits early if so.</li>
<li>Executes control logic at a fixed rate using the DO_EVERY macro.</li>
<li>Iterates through all motors, running each one.</li>
<li>For the clamp motor, synchronizes its speed with the jaw rotation motor and adjusts the speed to account for any additional required movement based on error.</li>
</ul>
<p>The function ensures coordinated movement between the jaw rotation and clamp motors, and enforces speed limits for safe operation. </p>

</div>
</div>
<a id="a6fed5f818bc46e22a3af4150ca9ed761" name="a6fed5f818bc46e22a3af4150ca9ed761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fed5f818bc46e22a3af4150ca9ed761">&#9670;&#160;</a></span>shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Cleaner::shutdown </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Safely shuts down the cleaner system by stopping all motors and setting the emergency stop flag. </p>
<p>This function kills the jaw rotation motor, jaw position motor, and clamp motor to ensure all moving parts are halted. It also sets the emergency stop state to true, indicating that the system is in a stopped condition.</p>
<dl class="section return"><dt>Returns</dt><dd>int Returns EXIT_SUCCESS upon successful shutdown. </dd></dl>

</div>
</div>
<a id="a968b84237dc3e9425cfea3e4c771f5cd" name="a968b84237dc3e9425cfea3e4c771f5cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968b84237dc3e9425cfea3e4c771f5cd">&#9670;&#160;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cleaner::stop </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops all motors managed by the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> instance. </p>
<p>This function iterates through all motors, issuing stop commands and running each motor until all have completely stopped. The function blocks until no motors are reported as running. </p>

</div>
</div>
<a id="aa310ec1a7161cf0a40e3ac37836c2acd" name="aa310ec1a7161cf0a40e3ac37836c2acd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa310ec1a7161cf0a40e3ac37836c2acd">&#9670;&#160;</a></span>updateDesStateManual()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">Cleaner::State</a> Cleaner::updateDesStateManual </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the desired state of the cleaner system in manual mode based on encoder inputs. </p>
<p>This function reads the current positions from the jaw rotation, jaw position, and clamp encoders, computes the deltas since the last update, and applies these changes to the desired state using configurable sensitivity and speed factors. It also updates the brake state based on the current brake switch status. The function ensures that encoder values are stored for the next update cycle.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">Cleaner::State</a> The updated desired state of the cleaner system. </dd></dl>

</div>
</div>
<a id="a54f9a4e625933e4f5bdc16f3b6ac0f5e" name="a54f9a4e625933e4f5bdc16f3b6ac0f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54f9a4e625933e4f5bdc16f3b6ac0f5e">&#9670;&#160;</a></span>updatePCF8575()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Cleaner::updatePCF8575 </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the state of the PCF8575 I/O expander and related system components. </p>
<p>This function performs the following tasks:</p><ul>
<li>Updates the state of the encoder objects for clamp, jaw position, and jaw rotation.</li>
<li>Reads the raw state of the encoder dial buttons from the I/O expander and updates their state.</li>
<li>Toggles the button state for each encoder button.</li>
<li>Reads the state of the roll brake switch and updates the corresponding flag.</li>
<li>Updates the LED indicators for encoder speed based on the current speed settings.</li>
<li>Reads the mode pin to determine if the system is in auto mode.</li>
<li>Sends the accumulated I2C commands to the PCF8575 I/O expander.</li>
</ul>
<p>This function should be if the updatePCF8575_flag is true </p>

</div>
</div>
<a id="a0202b0d88fc67277b9f6590164830576" name="a0202b0d88fc67277b9f6590164830576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0202b0d88fc67277b9f6590164830576">&#9670;&#160;</a></span>updateRealState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">Cleaner::State</a> Cleaner::updateRealState </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates and returns the real-time state of the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system. </p>
<p>This function checks the emergency stop (ESTOP) pin and, if triggered, sets the system to an emergency stopped state and initiates shutdown. It then updates the jaw rotation and clamp position based on the current positions of their respective motors. The clamp position is calculated relative to the jaw rotation. The function also updates the brake state by reading the corresponding hardware pin.</p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d2/dd7/structCleaner_1_1State.html">Cleaner::State</a> The updated state of the <a class="el" href="../../d3/dfb/classCleaner.html">Cleaner</a> system, reflecting the latest hardware readings and safety status. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="../../da/d59/cleaner__system_8hpp_source.html">cleaner_system.hpp</a></li>
<li>src/<b>cleaner_system.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
